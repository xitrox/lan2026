<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LAN Party 2026 - Operation Reunion</title>

    <!-- PWA Meta Tags -->
    <meta name="description" content="Event-Management f√ºr die LAN Party 2026">
    <meta name="theme-color" content="#6366f1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="LAN 2026">

    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">

    <!-- Favicon & Icons -->
    <link rel="icon" type="image/png" sizes="192x192" href="/icons/icon-192x192.png">
    <link rel="apple-touch-icon" href="/icons/icon-192x192.png">

    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Background texture overlay -->
    <div class="texture-overlay"></div>

    <!-- ============================================ -->
    <!-- LOGIN / REGISTRATION SCREEN -->
    <!-- ============================================ -->
    <div id="auth-screen" class="auth-screen">
        <div class="auth-container">
            <div class="auth-header">
                <div class="logo">
                    <span id="auth-event-title" class="logo-text">LAN PARTY 2026</span>
                </div>
            </div>

            <!-- Login Form -->
            <div id="login-form" class="auth-form">
                <h2 class="auth-title">Anmeldung</h2>
                <form id="login-form-element">
                    <div class="form-group">
                        <label for="login-username" class="form-label">Benutzername</label>
                        <input type="text" id="login-username" class="form-input" required autocomplete="username">
                    </div>
                    <div class="form-group">
                        <label for="login-password" class="form-label">Passwort</label>
                        <input type="password" id="login-password" class="form-input" required autocomplete="current-password">
                    </div>
                    <button type="submit" class="submit-btn">
                        <span class="btn-text">Anmelden</span>
                        <span class="btn-icon">‚Üí</span>
                    </button>
                </form>
                <p class="auth-switch">
                    Noch kein Account? <a href="#" id="show-register">Jetzt registrieren</a>
                </p>
                <div id="login-error" class="auth-error" style="display: none;"></div>
            </div>

            <!-- Registration Form -->
            <div id="register-form" class="auth-form" style="display: none;">
                <h2 class="auth-title">Registrierung</h2>
                <p class="auth-subtitle">Ben√∂tigt: Gemeinsames Registrierungspasswort</p>
                <form id="register-form-element">
                    <div class="form-group">
                        <label for="reg-username" class="form-label">Benutzername</label>
                        <input type="text" id="reg-username" class="form-input" required autocomplete="username">
                    </div>
                    <div class="form-group">
                        <label for="reg-email" class="form-label">E-Mail</label>
                        <input type="email" id="reg-email" class="form-input" required autocomplete="email">
                    </div>
                    <div class="form-group">
                        <label for="reg-password" class="form-label">Passwort</label>
                        <input type="password" id="reg-password" class="form-input" required autocomplete="new-password">
                    </div>
                    <div class="form-group">
                        <label for="reg-registration-password" class="form-label">Registrierungspasswort</label>
                        <input type="password" id="reg-registration-password" class="form-input" required>
                        <small class="form-hint">Dieses Passwort wurde euch privat mitgeteilt</small>
                    </div>
                    <button type="submit" class="submit-btn">
                        <span class="btn-text">Registrieren</span>
                        <span class="btn-icon">‚Üí</span>
                    </button>
                </form>
                <p class="auth-switch">
                    Bereits registriert? <a href="#" id="show-login">Zur Anmeldung</a>
                </p>
                <div id="register-error" class="auth-error" style="display: none;"></div>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- MAIN APPLICATION (hidden initially) -->
    <!-- ============================================ -->
    <div id="app-screen" class="app-screen" style="display: none;">

        <!-- Header -->
        <header class="header">
            <div class="container">
                <div class="header-content">
                    <div class="logo">
                        <span id="app-event-title" class="logo-text">LAN PARTY 2026</span>
                    </div>
                    <div class="header-actions">
                        <!-- Desktop Actions -->
                        <span id="user-display" class="user-display desktop-only"></span>
                        <button id="user-menu-btn" class="icon-btn desktop-only" title="Benutzermen√º">
                            ‚öôÔ∏è
                        </button>
                        <button id="help-btn" class="icon-btn desktop-only" title="Hilfe">
                            ‚ùì
                        </button>
                        <button id="logout-btn" class="icon-btn desktop-only" title="Abmelden">
                            üö™
                        </button>

                        <!-- Mobile: User Avatar as Menu Button -->
                        <button id="mobile-user-avatar-btn" class="user-avatar-btn mobile-only" title="Men√º">
                            <span id="user-avatar-initial" class="user-avatar-initial">?</span>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Mobile Menu Overlay -->
        <div id="mobile-menu" class="mobile-menu">
            <div class="mobile-menu-header">
                <span class="mobile-menu-title">MEN√ú</span>
                <button id="mobile-menu-close" class="mobile-menu-close">&times;</button>
            </div>
            <nav class="mobile-menu-nav">
                <button class="mobile-nav-item" data-navigate="home">üè† Home</button>
                <button class="mobile-nav-item" data-navigate="cabins">üèïÔ∏è Unterk√ºnfte</button>
                <button class="mobile-nav-item" data-navigate="games">üéÆ Spiele</button>
                <button class="mobile-nav-item" data-navigate="profile">üë§ Profil</button>
                <button id="mobile-admin-nav" class="mobile-nav-item" data-navigate="admin" style="display: none;">‚öôÔ∏è Admin</button>
            </nav>
            <div class="mobile-menu-actions">
                <button id="mobile-settings-btn" class="mobile-action-btn">
                    <span class="mobile-action-icon">‚öôÔ∏è</span>
                    <span class="mobile-action-text">Einstellungen</span>
                </button>
                <button id="mobile-help-btn" class="mobile-action-btn">
                    <span class="mobile-action-icon">‚ùì</span>
                    <span class="mobile-action-text">Hilfe</span>
                </button>
                <button id="mobile-logout-btn" class="mobile-action-btn">
                    <span class="mobile-action-icon">üö™</span>
                    <span class="mobile-action-text">Abmelden</span>
                </button>
            </div>
        </div>

        <!-- Event Info Section (always visible) -->
        <section class="event-info-section event-info-top">
            <div class="container">
                <!-- Event Date & Countdown (Date prominent) -->
                <div class="event-countdown-hero">
                    <div class="countdown-main">
                        <!-- Date FIRST and LARGE -->
                        <div id="event-date-hero" class="event-date-hero-large">TBD</div>

                        <!-- Simple countdown (days only) -->
                        <div class="countdown-simple">
                            <span id="countdown-days" class="countdown-days-large">--</span>
                            <span class="countdown-label-simple">Tage bis zum Event</span>
                        </div>
                    </div>
                </div>

                <div class="event-info-grid">
                    <div class="event-info-card">
                        <div class="info-icon">üë•</div>
                        <div class="info-content">
                            <div class="info-label">Teilnehmer</div>
                            <div id="event-participants" class="info-value">0/10</div>
                            <div id="participants-list" class="participants-list"></div>
                        </div>
                    </div>
                    <div class="event-info-card">
                        <div class="info-icon">üìç</div>
                        <div class="info-content">
                            <div class="info-label">Ort</div>
                            <div id="event-location" class="info-value">TBD</div>
                        </div>
                    </div>
                </div>

                <!-- Top 3 Games & Add Game -->
                <div class="top-games">
                    <div class="top-games-header">
                        <h3 class="top-games-title">üéÆ Top 3 Spiele</h3>
                        <button id="home-add-game-btn" class="icon-btn-small" title="Spiel hinzuf√ºgen">+</button>
                    </div>
                    <div id="top-games-list" class="top-games-list">
                        <div class="top-game-item">L√§dt...</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Message Board (Prominent) -->
        <section class="message-board-section">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">üí¨ Message Board</h2>
                </div>
                <div class="chat-container">
                    <div id="chat-messages" class="chat-messages">
                        <!-- Messages will be loaded here -->
                    </div>
                    <div class="chat-input-wrapper">
                        <input type="text" id="chat-input" class="chat-input" placeholder="Nachricht eingeben... (^1 f√ºr Farben)" maxlength="1024">
                        <button id="chat-send-btn" class="chat-send-btn">Senden</button>
                    </div>
                </div>
            </div>
        </section>

    </div>

    <!-- ============================================ -->
    <!-- CABINS SCREEN (Full Page) -->
    <!-- ============================================ -->
    <div id="cabins-screen" class="page-screen" style="display: none;">
        <div class="page-header">
            <button class="page-back-btn" data-navigate="home">‚Üê Home</button>
            <h2 class="page-title">Unterk√ºnfte</h2>
            <button id="add-cabin-btn" class="icon-btn" style="display: none;">+</button>
        </div>
        <div class="page-content">
            <div class="container">
                <div id="cabins-grid" class="cabins-grid">
                    <p>L√§dt...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- GAMES SCREEN (Full Page) -->
    <!-- ============================================ -->
    <div id="games-screen" class="page-screen" style="display: none;">
        <div class="page-header">
            <button class="page-back-btn" data-navigate="home">‚Üê Home</button>
            <h2 class="page-title">Spiele</h2>
            <button id="add-game-btn" class="icon-btn">+</button>
        </div>
        <div class="page-content">
            <div class="container">
                <div id="games-list" class="games-list">
                    <p>L√§dt...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- PROFILE SCREEN (Full Page) -->
    <!-- ============================================ -->
    <div id="profile-screen" class="page-screen" style="display: none;">
        <div class="page-header">
            <button class="page-back-btn" data-navigate="home">‚Üê Home</button>
            <h2 class="page-title">Profil</h2>
            <button class="icon-btn" style="display: none;">+</button>
        </div>
        <div class="page-content">
            <div class="container">
                <div class="profile-form-container">
                    <form id="profile-form">
                        <div class="form-group">
                            <label for="profile-username" class="form-label">Benutzername</label>
                            <input type="text" id="profile-username" class="form-input" disabled>
                        </div>
                        <div class="form-group">
                            <label for="profile-email" class="form-label">E-Mail</label>
                            <input type="email" id="profile-email" class="form-input" required>
                        </div>
                        <div class="form-group">
                            <div class="attendance-toggle">
                                <label class="toggle-label">
                                    <input type="checkbox" id="profile-is-attending" class="toggle-checkbox">
                                    <span class="toggle-slider"></span>
                                    <span class="toggle-text">Ich nehme am Event teil</span>
                                </label>
                                <small class="form-hint">Aktivieren, um in der Teilnehmerliste zu erscheinen</small>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Passwort √§ndern (optional)</label>
                            <input type="password" id="profile-current-password" class="form-input" placeholder="Aktuelles Passwort" autocomplete="current-password">
                        </div>
                        <div class="form-group">
                            <input type="password" id="profile-new-password" class="form-input" placeholder="Neues Passwort (min. 6 Zeichen)" autocomplete="new-password">
                        </div>
                        <button type="submit" class="submit-btn">
                            <span class="btn-text">Profil aktualisieren</span>
                            <span class="btn-icon">‚Üí</span>
                        </button>
                    </form>
                    <div id="profile-message" class="form-response" style="display: none;"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- ADMIN SCREEN (Full Page) -->
    <!-- ============================================ -->
    <div id="admin-screen" class="page-screen" style="display: none;">
        <div class="page-header">
            <button class="page-back-btn" data-navigate="home">‚Üê Home</button>
            <h2 class="page-title">Admin</h2>
            <button class="icon-btn" style="display: none;">+</button>
        </div>
        <div class="page-content">
            <div class="container">
                <div class="admin-sections">
                    <!-- Event Data Management -->
                    <div class="admin-section">
                        <h3 class="admin-section-title">Event-Stammdaten</h3>
                        <form id="admin-event-form">
                            <div class="form-group">
                                <label for="admin-event-title" class="form-label">Titel</label>
                                <input type="text" id="admin-event-title" class="form-input">
                            </div>
                            <div class="form-group">
                                <label for="admin-event-date" class="form-label">Start (Datum & Uhrzeit)</label>
                                <input type="datetime-local" id="admin-event-date" class="form-input">
                            </div>
                            <div class="form-group">
                                <label for="admin-event-date-end" class="form-label">Ende (Datum & Uhrzeit) - Optional</label>
                                <input type="datetime-local" id="admin-event-date-end" class="form-input">
                            </div>
                            <div class="form-group">
                                <label for="admin-event-location" class="form-label">Ort</label>
                                <input type="text" id="admin-event-location" class="form-input">
                            </div>
                            <div class="form-group">
                                <label for="admin-event-password" class="form-label">Registrierungspasswort</label>
                                <input type="text" id="admin-event-password" class="form-input">
                            </div>
                            <button type="submit" class="submit-btn">Speichern</button>
                        </form>
                    </div>

                    <!-- User Management -->
                    <div class="admin-section">
                        <h3 class="admin-section-title">Benutzerverwaltung</h3>
                        <div id="admin-users-list" class="admin-users-list">
                            <p>L√§dt...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- MODALS -->
    <!-- ============================================ -->

    <!-- Help Modal -->
    <div id="help-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Hilfe & Color Codes</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <h4>Enemy Territory Color Codes</h4>
                <p>Verwende diese Codes in Chat-Nachrichten, um Text zu f√§rben:</p>
                <div class="color-codes-list">
                    <div class="color-code-item"><span class="et-color-0">^0 Schwarz</span></div>
                    <div class="color-code-item"><span class="et-color-1">^1 Rot</span></div>
                    <div class="color-code-item"><span class="et-color-2">^2 Gr√ºn</span></div>
                    <div class="color-code-item"><span class="et-color-3">^3 Gelb</span></div>
                    <div class="color-code-item"><span class="et-color-4">^4 Blau</span></div>
                    <div class="color-code-item"><span class="et-color-5">^5 Cyan</span></div>
                    <div class="color-code-item"><span class="et-color-6">^6 Magenta</span></div>
                    <div class="color-code-item"><span class="et-color-7">^7 Wei√ü</span></div>
                </div>
                <h4>Beispiel</h4>
                <p><code>^1Hallo ^7Welt ^2!</code> wird zu: <span class="et-color-1">Hallo</span> <span class="et-color-7">Welt</span> <span class="et-color-2">!</span></p>
            </div>
        </div>
    </div>

    <!-- Add Cabin Modal -->
    <div id="add-cabin-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Unterkunft hinzuf√ºgen</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="add-cabin-form">
                    <div class="form-group">
                        <label for="cabin-name" class="form-label">Name</label>
                        <input type="text" id="cabin-name" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label for="cabin-url" class="form-label">URL (z.B. Airbnb-Link)</label>
                        <input type="url" id="cabin-url" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="cabin-image" class="form-label">Bild-URL</label>
                        <input type="url" id="cabin-image" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="cabin-description" class="form-label">Beschreibung</label>
                        <textarea id="cabin-description" class="form-textarea" rows="3"></textarea>
                    </div>
                    <button type="submit" class="submit-btn">Hinzuf√ºgen</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Add Game Modal -->
    <div id="add-game-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Spiel hinzuf√ºgen</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="add-game-form">
                    <div class="form-group">
                        <label for="game-name" class="form-label">Spielname</label>
                        <input type="text" id="game-name" class="form-input" required>
                    </div>
                    <button type="submit" class="submit-btn">Hinzuf√ºgen</button>
                </form>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- SETTINGS SCREEN -->
    <!-- ============================================ -->
    <div id="settings-screen" class="settings-screen" style="display: none;">
        <div class="settings-header">
            <button id="settings-back-btn" class="icon-btn" title="Zur√ºck">
                ‚Üê Zur√ºck
            </button>
            <h2 class="settings-title">Einstellungen</h2>
            <div style="width: 48px;"></div> <!-- Spacer for centering -->
        </div>

        <div class="settings-container">
            <!-- Account Settings Section -->
            <div class="settings-section">
                <h3 class="settings-section-title">Account</h3>

                <div class="settings-item">
                    <div class="settings-item-label">Benutzername</div>
                    <div id="settings-username" class="settings-item-value">-</div>
                </div>

                <div class="settings-item">
                    <div class="settings-item-label">E-Mail</div>
                    <input type="email" id="settings-email" class="settings-input">
                </div>

                <div class="settings-item">
                    <div class="settings-item-label">Teilnahme am Event</div>
                    <label class="toggle-label">
                        <input type="checkbox" id="settings-is-attending" class="toggle-checkbox">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
            </div>

            <!-- Password Change Section -->
            <div class="settings-section">
                <h3 class="settings-section-title">Passwort √§ndern</h3>

                <div class="settings-item">
                    <input type="password" id="settings-current-password" class="settings-input" placeholder="Aktuelles Passwort" autocomplete="current-password">
                </div>

                <div class="settings-item">
                    <input type="password" id="settings-new-password" class="settings-input" placeholder="Neues Passwort (min. 6 Zeichen)" autocomplete="new-password">
                </div>
            </div>

            <!-- Notification Settings Section -->
            <div class="settings-section">
                <h3 class="settings-section-title">Benachrichtigungen</h3>

                <div class="notification-status">
                    <div id="settings-notification-unsupported" class="notification-warning" style="display: none;">
                        üîï Push-Benachrichtigungen werden von diesem Browser nicht unterst√ºtzt
                    </div>
                    <div id="settings-notification-denied" class="notification-warning" style="display: none;">
                        üîï Benachrichtigungen wurden blockiert. Bitte in den Browser-Einstellungen aktivieren.
                    </div>
                    <div id="settings-notification-enabled" class="notification-success" style="display: none;">
                        üîî Push-Benachrichtigungen sind aktiviert
                    </div>
                    <div id="settings-notification-disabled" class="notification-info" style="display: none;">
                        üîï Push-Benachrichtigungen sind deaktiviert
                    </div>
                </div>

                <button id="settings-enable-notifications-btn" class="notification-toggle-btn" style="display: none;">
                    <span class="btn-text">Benachrichtigungen aktivieren</span>
                    <span class="btn-icon">üîî</span>
                </button>

                <div id="settings-notification-preferences" style="display: none;">
                    <p class="form-hint" style="margin-bottom: 1rem;">W√§hle aus, √ºber welche Aktivit√§ten du benachrichtigt werden m√∂chtest:</p>

                    <div class="settings-item">
                        <div class="settings-item-label">üí¨ Chat-Nachrichten</div>
                        <label class="toggle-label">
                            <input type="checkbox" id="settings-notify-chat" class="toggle-checkbox" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>

                    <div class="settings-item">
                        <div class="settings-item-label">üéÆ Neue Spiele</div>
                        <label class="toggle-label">
                            <input type="checkbox" id="settings-notify-games" class="toggle-checkbox" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>

                    <div class="settings-item">
                        <div class="settings-item-label">üè† Unterk√ºnfte</div>
                        <label class="toggle-label">
                            <input type="checkbox" id="settings-notify-accommodations" class="toggle-checkbox" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Save Button -->
            <button id="save-settings-btn" class="submit-btn">
                <span class="btn-text">Einstellungen speichern</span>
                <span class="btn-icon">‚Üí</span>
            </button>
            <div id="settings-message" class="form-response" style="display: none;"></div>
        </div>
    </div>

    <!-- Voice Menu (Easter Egg - Press V) -->
    <div id="voice-menu" class="voice-menu" style="display: none;">
        <div class="voice-menu-overlay"></div>
        <div class="voice-menu-container">
            <div class="voice-menu-header">
                <span class="voice-menu-title">VOICE COMMANDS</span>
                <span class="voice-menu-hint">Dr√ºcke ESC zum Schlie√üen</span>
            </div>

            <!-- Main Categories -->
            <div id="voice-categories" class="voice-menu-categories">
                <div class="voice-category" data-category="statements">
                    <span class="voice-number">1</span>
                    <span class="voice-label">Statements</span>
                </div>
                <div class="voice-category" data-category="requests">
                    <span class="voice-number">2</span>
                    <span class="voice-label">Requests</span>
                </div>
                <div class="voice-category" data-category="commands">
                    <span class="voice-number">3</span>
                    <span class="voice-label">Commands</span>
                </div>
                <div class="voice-category" data-category="responses">
                    <span class="voice-number">4</span>
                    <span class="voice-label">Responses</span>
                </div>
                <div class="voice-category" data-category="reactions">
                    <span class="voice-number">5</span>
                    <span class="voice-label">Reactions</span>
                </div>
            </div>

            <!-- Sub Menu (shown when category selected) -->
            <div id="voice-submenu" class="voice-submenu" style="display: none;">
                <!-- Populated dynamically -->
            </div>
        </div>
    </div>

    <script src="app.js"></script>

    <!-- Dev Hot Reload (only works in development) -->
    <script>
    if (location.hostname === 'localhost' || location.hostname === '127.0.0.1') {
        let lastModified = {};
        setInterval(() => {
            ['app.js', 'styles.css'].forEach(file => {
                fetch(file, { method: 'HEAD', cache: 'no-cache' }).then(r => {
                    const mod = r.headers.get('last-modified');
                    if (lastModified[file] && lastModified[file] !== mod) location.reload();
                    lastModified[file] = mod;
                });
            });
        }, 1000);
    }
    </script>
</body>
</html>
